Up next, you will configure and run the SPIRE Agent.

View the SPIRE Agent configuration file:
` cat agent.conf`{{execute}}

Set the trust domain to match the same trust domain as configured in the corrresponding SPIRE Server configuration.

Set `trust_domain` to [[HOST_SUBDOMAIN]]-80-[[KATACODA_HOST]].environments.katacoda.com in agent.conf
`sed -i 's/<TRUST_DOMAIN>/[[HOST_SUBDOMAIN]]-80-[[KATACODA_HOST]].environments.katacoda.com/g' agent.conf`{{execute}}

We'll verify the change:
`grep katacoda agent.conf`{{execute}}

The other Spire Agent configuration options are OK as is for this simple demo. If you are really curious about them, see [Agent configuration file](https://github.com/spiffe/spire/blob/master/doc/spire_agent.md#agent-configuration-file).

There are several methods by which characteristics of a SPIRE Agent's node (host) will be verified ("attested," in SPIFFE terms) to join a trust domain. Here we will use join token node attestation. The join_token plugin attests the SPIRE Agent's node based on a pre-shared, one-time-use join token generated by a SPIRE Server.

Generate a join token by running this command on the SPIRE Server:
``JOIN_TOKEN=`(/opt/spire-0.9.1/bin/spire-server token generate -spiffeID spiffe://[[HOST_SUBDOMAIN]]-80-[[KATACODA_HOST]].environments.katacoda.com/clientnode| awk '{print $2}' | tr -d '\r')` ``{{execute}}

We've copied the join token into the JOIN_TOKEN environment variable to make the next command easier. Here's what the token looks like:
`echo $JOIN_TOKEN`

Start the SPIRE Agent using the join token from the SPIRE Server:
``/opt/spire-0.9.1/bin/spire-agent run -config agent.conf -joinToken `echo $JOIN_TOKEN` &``{{execute}}
In the log messages output from the SPIRE Agent, you should see a `Node attestation request completed` message.
